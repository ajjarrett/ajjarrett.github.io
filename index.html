<html>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <style> circle {fill: lightblue; stroke: black;}</style>
    <link rel="stylesheet" href="/css/styles.css" />

    <body onload="init()">
    <div id="plot-area">
        <svg width="600" height="600"></svg>
    </div>
    <script>
    async function init() {

        // Set variable for svg, margin, width, height
        var svg = d3.select("svg"),
            margin = 100;
            width = +svg.attr("width") - 2*margin,
            height = +svg.attr("height") - 2*margin;

        //const path = "Programming_Languages.csv"

        // Data to Plot
        const data = [
            [1,1],
            [2,2],
            [3,10],
            [60, 80],
            [100, 95]
        ]

        // X Scale
        var x = d3.scaleLinear().domain([0,100]).range([0,width]);

        // Y Scale
        var y = d3.scaleLinear().domain([0,100]).range([height,0]);

        // Title
        svg.append('text')
        .attr('x', width/2 + margin)
        .attr('y', margin/2)
        .attr('text-anchor', 'middle')
        .style('font-size', 20)
        .text('Line Chart');

        // X label
        svg.append('text')
        .attr('x', width/2 + margin)
        .attr('y', height + margin + margin/2)
        .attr('text-anchor', 'middle')
        .style('font-size', 12)
        .text('Independent axis')

        // Y label
        svg.append('text')
        .attr('text-anchor', 'middle')
        .attr('transform', 'translate(' + margin/2 + ',' + (height/2 + margin) + ')rotate(-90)')
        .style('font-size', 12)
        .text('Dependent');

        // Left Axis
        svg.append('g')
        .attr('transform', 'translate(' + margin + ',' + margin + ')')
        .call(d3.axisLeft(y));

        // Bottom Axis
        svg.append('g')
        .attr('transform', 'translate(' + margin + ',' + (height + margin) + ')')
        .call(d3.axisBottom(x));



        // (opacity of 1 == completely opaque), (opacity of 0 == completely transparent/hidden)
        // stroke is used to add a border to SVG shapes
        var mouseover = function(d) {
            my_tooltip.style('opacity', 1)
            d3.select(this).style('stroke', 'black').style('opacity', 1)
        }

        var mousemove = function(d) {
            my_tooltip
            .html('value is ' + d[0])
            .style('left', (d3.mouse(this)[0]+70) + 'px')
            .style('top', (d3.mouse(this)[1]) + 'px')
        }

        var mouseleave = function(d) {
            my_tooltip
            .style('opacity', 0)
            d3.select(this)
            .style('stroke', 'none')
            .style('opacity', 0.8)
        }

        // Add Scatter dots
        svg.append('g')
        .selectAll('dot')
        .data(data)
        .enter()
        .append('circle')
        .attr('cx', function(d) {return x(d[0]);})
        .attr('cy', function(d) {return y(d[1]);})
        .attr('r', 5)
        .attr('transform', 'translate(' + margin + ',' + margin + ')')
        .style('fill', '#CC0000')
        .on('mouseover', mouseover)
        .on('mousemove', mousemove)
        .on('mouseleave', mouseleave);



        // Plot line
        var line = d3.line()
            .x(function(d) {return x(d[0]);})
            .y(function(d) {return y(d[1]);})

        svg.append("path")
        .datum(data)
        .attr('class', 'line')
        .attr('transform', 'translate(' + margin + ',' + margin + ')')
        .attr('d', line)
        .attr("fill", "none")
        .attr("stroke", "steelblue")
        .attr("stroke-width", '2');

        // Basic line chart reference: https://www.educative.io/answers/how-to-create-a-line-chart-using-d3

        // Tooltips reference: https://d3-graph-gallery.com/graph/interactivity_tooltip.html
        // create a tooltip
        var my_tooltip = d3.select('#plot-area')
        .append('div')
        .style('opacity', 0)
        .attr('class', 'tooltip')
        .style('background-color', 'white')
        .style('border', 'solid')
        .style('border-width', '2px')
        .style('border-radius', '5px')
        .style('padding', '5px');




        /*
        d3.selectAll("circle")
        .on("mouseover", function(d, i) {return tooltip.style("opacity", 1)
        .style("left", (d3.event.pageX)+"px")
        .style("top", (d3.event.pageY)+"px")
        .html("Item #" + i + " is " + d);
        });
        */

        // TODO-1: add multiple lines to chart
        // TODO-2: add filters
        // TODO-3: add real data
        // TODO-3: add pages with explanations and ability to navigate between them
    }

    </script>
    </body>
</html>